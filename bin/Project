#!/usr/bin/env python
"""
This utility helps with my projects. Valid subcommands:
[1] CreateProject
[2] ListProjects
"""

import os
import sys

sys.path.append(os.path.dirname(os.path.realpath(__file__)) + "/../")
sys.dont_write_bytecode = True

from libs.CreateProject import CreateProject, CreateProjectException
from libs.Utils import Utils

def show_projects():
    print("Available projects:\n")
    if os.path.isdir(CreateProject.conf["ConfRoot"]):
        for f in os.listdir(CreateProject.conf["ConfRoot"]):
            if os.path.isfile(os.path.join(CreateProject.conf["ConfRoot"], f)) and not f == ".config":
                print("[Project]: " + f)
                print(open(os.path.join(CreateProject.conf["ConfRoot"] ,f)).read())
    print("\n")

def main():
    args = sys.argv
    if len(args) < 2:
        print("ERROR: Command required")
        print(__doc__)
        return 1
    command = args[1]
    args = args[2:]

    if command == "CreateProject":
        try:
            return CreateProject.getopts(args)
        except CreateProjectException as e:
            Utils.error(str(e))
    elif command == "ListProjects":
        show_projects()
    else:
        print("ERROR: Wrong command: " + command)
        print(__doc__)
        return 1

if __name__ == "__main__":
    main()